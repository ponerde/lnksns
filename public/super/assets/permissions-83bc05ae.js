import{m as s,r as B,c as E,a as d,o as F,b as O,e as n,w as u,k as i,n as k}from"./index-517d70fb.js";import{l as S}from"./index-65d942f6.js";/* empty css                                                              */const j={__name:"permissions",emits:["success","close"],setup(T,{expose:v,emit:m}){const r=s(null),c=s(null),f=s("add"),p=s([]),_=s(),a=s({id:0,defaultCheckedKeys:[]}),g=B({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,message:"用户名最小为3个字符串"}]}),y=s([]),C=E(()=>f.value=="edit"?"编辑用户":"新增用户"),R=async()=>{const e=await i.role.list();y.value=e.data},b=async e=>{const t=await i.menu.list({});p.value=t.data,a.value.id=e.id,a.value.defaultCheckedKeys=e.rules},w=(e="add")=>{f.value=e,r.value.open()},h=()=>{c.value.resetFields(),r.value.close(),m("close")},x=async()=>{var l;await((l=c.value)==null?void 0:l.validate());const e=_.value.getCheckedKeys(),t=a.value.id;let o=await i.role.update({rules:e,id:t});o.error?k.msgError(o.msg):(h(),m("success"),k.msgSuccess(o.msg))},K=async()=>{h()};return R(),v({open:w,setFormData:b}),(e,t)=>{const o=d("el-tree"),l=d("el-form-item"),D=d("el-form");return F(),O("div",null,[n(S,{ref_key:"dialogRef",ref:r,title:C.value,async:!0,width:"550px",onConfirm:x,onCancel:K},{default:u(()=>[n(D,{ref_key:"formRef",ref:c,model:a.value,"label-width":"84px",rules:g},{default:u(()=>[n(l,{label:"权限"},{default:u(()=>[n(o,{"default-expand-all":"",data:p.value,"node-key":"permission_mark",props:{label:"permission_name"},"default-checked-keys":a.value.defaultCheckedKeys,ref_key:"prmissionRef",ref:_,"show-checkbox":"",onCheckChange:e.handleCheckChange},null,8,["data","default-checked-keys","onCheckChange"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])])}}};export{j as default};
